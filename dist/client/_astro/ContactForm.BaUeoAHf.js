import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.BVOCwoKb.js";const h="sbg_contact_form_draft",S="2 min pour remplir ce formulaire";function w(){const[r,d]=o.useState({lastname:"",firstname:"",phone:"",email:"",message:"",terms:!1,honeypot:""}),[t,g]=o.useState({}),[j]=o.useState(Date.now()),[p,c]=o.useState(null),[f,m]=o.useState(null),[u,b]=o.useState(!1);o.useEffect(()=>{const a=localStorage.getItem(h);a&&d(JSON.parse(a))},[]),o.useEffect(()=>{localStorage.setItem(h,JSON.stringify(r))},[r]),o.useEffect(()=>{const a=Object.values(t).every(n=>!n),s=!!(r.lastname&&r.firstname&&r.email&&r.message&&r.terms);b(a&&s)},[t,r]);const _=(a,s)=>{let n="";(a==="lastname"||a==="firstname"||a==="message")&&!s&&(n="Ce champ est requis."),a==="email"&&typeof s=="string"&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)||(n="Adresse email invalide.")),a==="phone"&&typeof s=="string"&&s.length>0&&(/^0\d{2,3}[ .-]?\d{2}[ .-]?\d{2}[ .-]?\d{2}$/.test(s)||(n="Format t√©l√©phone incorrect (ex : 0494 20 50 75).")),a==="terms"&&s!==!0&&(n="Vous devez accepter les conditions."),g(l=>({...l,[a]:n}))},i=a=>{const{name:s,value:n,type:l}=a.target,v=l==="checkbox"?a.target.checked:void 0,x=l==="checkbox"?v:n;d(E=>({...E,[s]:x})),_(s,x)},[C,N]=o.useState(!1),y=async a=>{if(a.preventDefault(),c(null),m(null),Date.now()-j<3e3){c("Merci de patienter au moins 3 secondes avant de valider.");return}if(r.honeypot)return;let s=!1;if(Object.entries(r).forEach(([n,l])=>{_(n,l),t[n]&&(s=!0)}),s||!u){c("Merci de corriger les erreurs avant d‚Äôenvoyer.");return}try{const l=await(await fetch("/api/contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json();if(l.success){m(!0),N(!0),d({lastname:"",firstname:"",phone:"",email:"",message:"",terms:!1,honeypot:""}),localStorage.removeItem(h),setTimeout(()=>{window.location.href="/thanks"},1800);return}else m(!1),c(l.error||"Erreur lors de l‚Äôenvoi.")}catch{m(!1),c("Erreur r√©seau, veuillez r√©essayer.")}};return e.jsx("div",{className:"wrapper-982-black",children:e.jsxs("section",{id:"footer-contact-form",className:"contact__form section-height90 ",children:[e.jsx("h2",{className:"contact__title title",children:"Formulaire de contact"}),e.jsx("p",{className:"contact__time-estimate","aria-hidden":"true",children:S}),e.jsx("p",{className:"contact__intro",children:"Toutes les informations inscrites dans ce formulaire seront directement envoy√©es √† notre bo√Æte mail."}),e.jsxs("form",{onSubmit:y,noValidate:!0,children:[e.jsx("input",{type:"text",name:"honeypot",value:r.honeypot,onChange:i,hidden:!0,tabIndex:-1,"aria-hidden":"true"}),e.jsxs("div",{className:"contact__wrapper-col1",children:[e.jsxs("fieldset",{className:"contact__personal",children:[e.jsx("legend",{children:"Informations personnelles"}),e.jsx("label",{htmlFor:"lastname",className:"contact__label",children:"Nom*"}),e.jsx("input",{type:"text",id:"lastname",name:"lastname",className:`contact__input ${t.lastname?"no-margin":""}`,required:!0,"aria-required":"true",autoComplete:"family-name",value:r.lastname,onChange:i}),t.lastname&&e.jsx("p",{className:"form__error",role:"alert",children:t.lastname}),e.jsx("label",{htmlFor:"firstname",className:"contact__label",children:"Pr√©nom*"}),e.jsx("input",{type:"text",id:"firstname",name:"firstname",className:`contact__input ${t.firstname?"no-margin":""}`,required:!0,"aria-required":"true",autoComplete:"given-name",value:r.firstname,onChange:i}),t.firstname&&e.jsx("p",{className:"form__error",role:"alert",children:t.firstname})]}),e.jsxs("fieldset",{className:"contact__information",children:[e.jsx("legend",{children:"Coordonn√©es"}),e.jsx("label",{htmlFor:"phone",className:"contact__label",children:"T√©l√©phone"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",className:`contact__input ${t.phone?"no-margin":""}`,autoComplete:"tel",pattern:"^(\\+32\\s?[1-9]{1}[0-9]?\\s?\\d{2}\\s?\\d{2}\\s?\\d{2}|\\b0[1-9]{1}[0-9]?\\s?\\d{2}\\s?\\d{2}\\s?\\d{2})$",placeholder:"04XX XX XX XX",value:r.phone,onChange:i}),t.phone&&e.jsx("p",{className:"form__error",role:"alert",children:t.phone}),e.jsx("label",{htmlFor:"email",className:"contact__label",children:"Email*"}),e.jsx("input",{type:"email",id:"email",name:"email",className:`contact__input ${t.email?"no-margin":""}`,required:!0,"aria-required":"true",autoComplete:"email",placeholder:"exemple@domaine.com",value:r.email,onChange:i}),t.email&&e.jsx("p",{className:"form__error",role:"alert",children:t.email})]})]}),e.jsxs("div",{className:"contact__wrapper-col2",children:[e.jsxs("fieldset",{className:"contact__message",children:[e.jsx("legend",{children:"Votre message"}),e.jsx("label",{htmlFor:"message",className:"contact__label",children:"Message*"}),e.jsx("textarea",{id:"message",name:"message",className:`contact__textarea ${t.message?"no-margin":""}`,required:!0,"aria-required":"true",value:r.message,onChange:i}),t.message&&e.jsx("p",{className:"form__error",role:"alert",children:t.message})]}),e.jsxs("fieldset",{className:"contact__terms",children:[e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",id:"terms",name:"terms",required:!0,"aria-required":"true",checked:r.terms,onChange:i}),e.jsxs("label",{htmlFor:"terms",children:["J'accepte les ",e.jsx("a",{href:"/LegalMentions",target:"_blank",rel:"noopener noreferrer",children:"mentions l√©gales"})," et les ",e.jsx("a",{href:"/PrivacyPolicy",target:"_blank",rel:"noopener noreferrer",children:"conditions d'utilisation"}),"."]})]}),t.terms&&e.jsx("p",{className:"form__error",role:"alert",children:t.terms})]}),p&&e.jsx("p",{className:"form__error",role:"alert",children:p}),f===!0&&e.jsx("p",{className:"form__success",role:"status",children:"Votre message a bien √©t√© envoy√© üéâ"}),f===!1&&e.jsx("p",{className:"form__error",role:"alert",children:"Erreur lors de l'envoi du formulaire."}),e.jsx("button",{type:"submit",className:`contact__button button button-red ${u?"":"button-disabled"}`,"aria-label":"Envoyer le formulaire de contact",disabled:!u,children:"Envoyer"})]})]})]})})}export{w as default};
